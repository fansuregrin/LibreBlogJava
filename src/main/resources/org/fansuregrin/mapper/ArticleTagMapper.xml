<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.fansuregrin.mapper.ArticleTagMapper">
  <insert id="insert">
    INSERT INTO article_tag (article, tag) VALUE (#{article}, #{tag})
  </insert>
  <update id="deleteByArticles">
    UPDATE article_tag SET delete_flag = '1'
    WHERE article IN
    <foreach collection="ids" item="item" index="index" open="(" close=")" separator=",">
      #{item}
    </foreach>
  </update>
  <update id="deleteByTags">
    UPDATE article_tag SET delete_flag = '1'
    WHERE tag IN
    <foreach collection="ids" item="item" index="index" open="(" close=")" separator=",">
      #{item}
    </foreach>
  </update>
  <update id="deleteByUsers">
    UPDATE article_tag at JOIN article a ON at.article = a.id
    SET at.delete_flag = '0' WHERE a.author_id IN
    <foreach collection="ids" item="item" index="index" open="(" close=")" separator=",">
      #{item}
    </foreach>
  </update>
</mapper>